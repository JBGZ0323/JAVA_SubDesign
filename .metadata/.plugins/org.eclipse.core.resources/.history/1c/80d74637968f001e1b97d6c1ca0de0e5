package textsystem;
import java.io.*;
import jxl.*;
import java.util.*;
import javax.swing.JOptionPane;

public class RamdomInitTestPaper implements GiveTestPaper {
	//将试题放入试卷（出卷）
	TestPaper testPaper;   //试卷
	File fileExcel;
	Problem [] problem;   //组成试卷的一套题，problem的单元存放一道题，即一个problem对象
	InputStream in = null;
	Workbook wb = null;   //封装Excel，Workbook是jxl包中的类
	Sheet sheet =null;    //封装Excel中的sheet，sheet是jxl包中的类
	LinkedList<Integer> list;   //随机抽取试题时用
	
	//RamdomInitTestPaper
	public RamdomInitTestPaper() {
		testPaper = new TestPaper();
		list = new LinkedList<Integer>();
	}
	
	//getTestPaper
	public TestPaper getTestPaper(String excelFileName, int amount) {
		boolean b = setExcel(excelFileName);   //设置用户存放试题的电子表格
		if(b) {
			try {
				randomGiveProblem(amount);   //随机给出amount道试题，见类后面的random GiveProblem
			}
			catch(ArrayIndexOutOfBoundsException e) {
				System.out.println("试题必须有类型，请检查题库");
				System.exit(0);
			}
			testPaper.setProblem(problem);   //试卷上设置的一套试题是problem
			return testPaper;                //返回试卷
		}
		else {
			JOptionPane.showMessageDialog(null,"没有预备题库","消息对话框",JOptionPane.WARNING_MESSAGE);
			return null;
		}
	}
	
}
